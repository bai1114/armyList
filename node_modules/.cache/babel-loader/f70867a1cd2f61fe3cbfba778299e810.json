{"ast":null,"code":"import _objectSpread from \"/Users/Flora/myapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/Flora/myapp/src/components/EditSoldier/index.js\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\n\nclass EditSoldier extends Component {\n  constructor(props) {\n    super(props);\n\n    this.filterSuperior = () => {\n      const result = [];\n      this.setState({\n        filteredSuperiors: result\n      });\n    };\n\n    this.traverse = (_id, list) => {\n      if (!_id || _id === '') {\n        return;\n      }\n\n      list.push(_id);\n      let directSubs = this.getDirectSubs(_id);\n\n      for (let ds of directSubs) {\n        this.traverse(ds, list);\n      }\n    };\n\n    this.getDirectSubs = _id => {\n      let result = [];\n      const employees = this.props.employees.employees;\n\n      for (let emp of employees) {\n        if (emp.managerId === _id) {\n          result.push(emp._id);\n        }\n      }\n\n      return result;\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n\n      let changedInfo = _objectSpread({}, this.state.changedInfo);\n\n      this.props.editSoldier(this.props.id, changedInfo);\n      this.setState({\n        redirect: true\n      });\n    };\n\n    this.handleChange = (e, key) => {\n      e.preventDefault();\n      const newObject = {};\n      newObject[key] = e.target.value;\n\n      const info = _objectSpread({}, this.state.info, newObject);\n\n      const changed = _objectSpread({}, this.state.changedInfo);\n\n      changed[key] = e.target.value;\n      this.setState({\n        info,\n        changedInfo: changed\n      });\n    };\n\n    this.handleSuperiorChange = e => {\n      let idName = e.target.value.split(' ');\n      const superiorId = idName[0];\n      const superiorName = idName[1];\n      const newObject = {\n        superiorId,\n        superiorName\n      };\n\n      const info = _objectSpread({}, this.state.info, newObject);\n\n      const changed = _objectSpread({}, this.state.changedInfo, {\n        superiorId\n      });\n\n      this.setState({\n        info,\n        changedInfo: changed\n      });\n    };\n\n    this.state = {\n      info: {\n        _id: null,\n        name: '',\n        sex: '',\n        rank: '',\n        startDate: '',\n        phone: '',\n        email: '',\n        superiorId: null,\n        superiorName: '',\n        numberOfDirectSubs: 0,\n        imgUrl: ''\n      },\n      changedInfo: {},\n      redirect: false,\n      filteredSuperiors: []\n    };\n  }\n\n  componentDidMount() {\n    for (let i = 0; i < this.props.soldiers.length; i++) {\n      if (this.props.soldiers[i]._id === this.props.id) {\n        this.setState({\n          info: this.props.soldiers[i]\n        });\n        console.log('startDate', this.props.soldiers[i].startDate);\n      }\n    }\n\n    this.filterSuperior();\n    setTimeout(() => {\n      this.setState({\n        filteredSuperiors: [...this.state.filteredSuperiors, this.state.info.superiorId]\n      });\n    }, 0);\n  }\n\n  render() {\n    const candidateSuperiors = this.props.soldiers.filter(superior => {\n      return !this.state.filteredSuperiors.includes(superior._id);\n    });\n    const _this$state = this.state,\n          info = _this$state.info,\n          redirect = _this$state.redirect;\n    console.log('redirect', redirect);\n    console.log('isloading', this.props.isLoading);\n\n    if (redirect && !this.props.isLoading) {\n      return React.createElement(Redirect, {\n        to: {\n          pathname: '/'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      });\n    } else {\n      return React.createElement(\"div\", {\n        className: \"edit_user\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, \"Edit Soldier\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }), React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        for: \"name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, \"Name:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"name\",\n        value: info.name,\n        onChange: e => this.handleChange(e, 'name'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"sex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"Sex:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"sex\",\n        value: info.sex,\n        onChange: e => this.handleChange(e, 'sex'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"rank\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, \"Rank:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"rank\",\n        value: info.rank,\n        onChange: e => this.handleChange(e, 'rank'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"startDate\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"Start Date:\"), React.createElement(\"input\", {\n        type: \"date\",\n        class: \"form-control\",\n        id: \"startDate\",\n        value: info.startDate,\n        onChange: e => this.handleChange(e, 'startDate'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"phone\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, \"Phone:\"), React.createElement(\"input\", {\n        type: \"number\",\n        class: \"form-control\",\n        id: \"phone\",\n        value: info.phone,\n        onChange: e => this.handleChange(e, 'phone'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"Email:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"email\",\n        value: info.email,\n        onChange: e => this.handleChange(e, 'email'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"Superior:\"), React.createElement(\"div\", {\n        className: \"col col-sm-10 col-lg-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(\"select\", {\n        id: \"manager\",\n        onChange: this.handleSuperiorChange,\n        className: \"form-control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: null,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, info.superiorName), candidateSuperiors.map(superior => {\n        return React.createElement(\"option\", {\n          key: superior._id,\n          value: superior._id + \" \" + superior.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, superior.name);\n      })))), React.createElement(\"button\", {\n        className: \"btn btn-success\",\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, \"Save Change\")));\n    }\n  }\n\n}\n\nexport default EditSoldier;","map":{"version":3,"sources":["/Users/Flora/myapp/src/components/EditSoldier/index.js"],"names":["React","Component","Redirect","EditSoldier","constructor","props","filterSuperior","result","setState","filteredSuperiors","traverse","_id","list","push","directSubs","getDirectSubs","ds","employees","emp","managerId","handleSubmit","e","preventDefault","changedInfo","state","editSoldier","id","redirect","handleChange","key","newObject","target","value","info","changed","handleSuperiorChange","idName","split","superiorId","superiorName","name","sex","rank","startDate","phone","email","numberOfDirectSubs","imgUrl","componentDidMount","i","soldiers","length","console","log","setTimeout","render","candidateSuperiors","filter","superior","includes","isLoading","pathname","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\n\nclass EditSoldier extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      info: {\n        _id: null,\n        name: '',\n        sex: '',\n        rank: '',\n        startDate: '',\n        phone: '',\n        email: '',\n        superiorId: null,\n        superiorName: '',\n        numberOfDirectSubs: 0,\n        imgUrl: '',\n      },\n      changedInfo: {},\n      redirect: false,\n      filteredSuperiors: []\n    };\n  }\n\n  componentDidMount() {\n    for (let i = 0; i < this.props.soldiers.length; i++){\n      if (this.props.soldiers[i]._id === this.props.id) {\n        this.setState({info : this.props.soldiers[i]});\n        console.log('startDate', this.props.soldiers[i].startDate);\n      }\n    }\n    this.filterSuperior();\n    setTimeout(() => {\n      this.setState({filteredSuperiors: [...this.state.filteredSuperiors,this.state.info.superiorId]});\n    }, 0); \n  }\n\n  filterSuperior = () => {\n    const result = [];\n    this.setState({filteredSuperiors: result});\n  }\n\n  traverse = (_id, list) => {\n    if (!_id || _id === '') {\n      return;\n    }\n    list.push(_id);\n    let directSubs = this.getDirectSubs(_id);\n    for (let ds of directSubs) {\n      this.traverse(ds, list);\n    }\n  };\n  getDirectSubs = _id => {\n    let result = [];\n    const employees = this.props.employees.employees;\n    for (let emp of employees) {\n      if (emp.managerId === _id) {\n        result.push(emp._id);\n      }\n    }\n    return result;\n  };\n\n  handleSubmit = e => {\n    e.preventDefault();\n    let changedInfo = {...this.state.changedInfo};\n    this.props.editSoldier(this.props.id, changedInfo);\n    this.setState({ redirect: true });\n  }\n\n  handleChange = (e, key) => {\n    e.preventDefault();\n    const newObject = {};\n    newObject[key] = e.target.value;\n    const info = {\n      ...this.state.info,\n      ...newObject\n    };\n    const changed = {...this.state.changedInfo};\n    changed[key] = e.target.value;\n    this.setState({ info, changedInfo: changed});\n  }\n\n  handleSuperiorChange = e => {\n    let idName = e.target.value.split(' ');\n    const superiorId = idName[0];\n    const superiorName = idName[1];\n    const newObject = { superiorId, superiorName };\n    const info = {\n      ...this.state.info,\n      ...newObject\n    };\n    const changed = {...this.state.changedInfo, superiorId};\n    this.setState({ info, changedInfo: changed });\n  };\n\n  render() {\n    const candidateSuperiors = this.props.soldiers.filter(superior => {\n      return !this.state.filteredSuperiors.includes(superior._id);\n    });\n    const { info, redirect } = this.state;\n    console.log('redirect', redirect);\n    console.log('isloading', this.props.isLoading);\n    if (redirect && !this.props.isLoading) {\n      return <Redirect to = {{ pathname: '/' }}/>\n    } else {\n      return (\n        <div className='edit_user'>\n          <h2>Edit Soldier</h2>\n          <br></br>\n          <form onSubmit = {this.handleSubmit}>\n            <div className=\"form-group col-md-50\" >\n              <label for = 'name'>\n                Name:\n              </label>\n              <input type = 'text' class = 'form-control' id = 'name' value = {info.name} onChange = {e => this.handleChange(e, 'name')} required = {true} />\n            </div> \n\n            <div className=\"form-group col-md-50\" >\n              <label htmlFor=\"sex\">\n                Sex:\n              </label>\n              <input type = 'text' class = 'form-control' id = 'sex' value = {info.sex} onChange = {e => this.handleChange(e, 'sex')} required = {true} />\n            </div>  \n            \n            <div className=\"form-group col-md-50\" >\n              <label  htmlFor=\"rank\">\n                Rank:\n              </label>\n              <input type = 'text' class = 'form-control' id = 'rank' value = {info.rank} onChange = {e => this.handleChange(e, 'rank')} required = {true}/>\n            </div>\n\n            <div className=\"form-group col-md-50\" >\n              <label htmlFor=\"startDate\">\n                Start Date:\n              </label>\n              <input type = 'date' class = 'form-control' id = 'startDate' value = {info.startDate} onChange = {e => this.handleChange(e, 'startDate')} required = {true}/>\n            </div>\n\n            <div className=\"form-group col-md-50\" >\n              <label htmlFor=\"phone\">\n                Phone:\n              </label>\n              <input type = 'number' class = 'form-control' id = 'phone' value = {info.phone} onChange = {e => this.handleChange(e, 'phone')} required = {true} />\n            </div>\n\n            <div className=\"form-group col-md-50\" > \n              <label htmlFor='text'>\n                Email: \n              </label> \n              <input type = 'text' class = 'form-control' id = 'email' value = {info.email} onChange = {e => this.handleChange(e, 'email')} required = {true} />\n            </div>\n\n            <div className=\"form-group col-md-50\" > \n              <label htmlFor='text'>\n                Superior: \n              </label> \n              <div className=\"col col-sm-10 col-lg-4\">\n                <select id=\"manager\" onChange={this.handleSuperiorChange} className=\"form-control\">\n                <option value={null}>{info.superiorName}</option>\n                {candidateSuperiors.map(superior => {\n                  return (\n                    <option key={superior._id} value={superior._id + \" \" + superior.name}>\n                      {superior.name}\n                    </option>\n                  );\n                })}\n                </select>\n              </div>\n            </div>\n\n            <button className=\"btn btn-success\" type = \"submit\">Save Change</button> \n          </form>\n        </div>\n      );\n    } \n  }\n}\n\nexport default EditSoldier;\n\n"]},"metadata":{},"sourceType":"module"}