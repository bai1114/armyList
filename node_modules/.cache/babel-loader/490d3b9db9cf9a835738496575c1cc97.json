{"ast":null,"code":"import _objectSpread from \"/Users/Flora/myapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/Flora/myapp/src/components/EditSoldier/index.js\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport moment from 'moment';\n\nclass EditSoldier extends Component {\n  constructor(props) {\n    super(props);\n\n    this.filterSuperior = () => {\n      const result = [];\n      this.traverse(this.props._id, result);\n      this.setState({\n        filteredSuperiors: result\n      });\n    };\n\n    this.traverse = (_id, list) => {\n      if (!_id || _id === '') {\n        return;\n      }\n\n      list.push(_id);\n      let directSubs = this.getDirectSubs(_id);\n\n      for (let ds of directSubs) {\n        this.traverse(ds, list);\n      }\n    };\n\n    this.getDirectSubs = _id => {\n      let result = [];\n      const soldiers = this.props.soldiers;\n\n      for (let soldier of soldiers) {\n        if (soldier.superiorId === _id) {\n          result.push(soldier._id);\n        }\n      }\n\n      return result;\n    };\n\n    this.handleChange = (e, key) => {\n      e.preventDefault();\n      const newObject = {};\n      newObject[key] = e.target.value;\n\n      const info = _objectSpread({}, this.state.info, newObject);\n\n      const changed = _objectSpread({}, this.state.changedInfo);\n\n      changed[key] = e.target.value;\n      this.setState({\n        info,\n        changedInfo: changed\n      });\n    };\n\n    this.handleSuperiorChange = e => {\n      let idName = e.target.value.split(' ');\n      const superiorId = idName[0];\n      const superiorName = idName[1];\n      const newObject = {\n        superiorId,\n        superiorName\n      };\n\n      const info = _objectSpread({}, this.state.info, newObject);\n\n      const changed = _objectSpread({}, this.state.changedInfo, {\n        superiorId\n      });\n\n      this.setState({\n        info,\n        changedInfo: changed\n      });\n    };\n\n    this.handleFile = () => {\n      const file = this.fileInput.files[0];\n      const filename = file.name;\n      const url = this.getObjectURL(file);\n      this.setState({\n        info: _objectSpread({}, this.state.info, {\n          imgUrl: url\n        })\n      });\n      this.props.uploadImage(file, filename);\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      let changedInfo;\n\n      if (this.props.image.imgUrl !== '') {\n        changedInfo = _objectSpread({}, this.state.changedInfo, {\n          imgUrl: this.props.image.imgUrl\n        });\n      } else {\n        changedInfo = _objectSpread({}, this.state.changedInfo);\n      }\n\n      this.props.editSoldier(this.props.id, changedInfo);\n    };\n\n    this.state = {\n      info: {\n        _id: null,\n        name: '',\n        sex: '',\n        rank: '',\n        startDate: '',\n        phone: '',\n        email: '',\n        superiorId: null,\n        superiorName: '',\n        numberOfDirectSubs: 0,\n        imgUrl: ''\n      },\n      changedInfo: {},\n      filteredSuperiors: []\n    };\n  }\n\n  componentDidMount() {\n    for (let i = 0; i < this.props.soldiers.length; i++) {\n      if (this.props.soldiers[i]._id === this.props.id) {\n        this.setState({\n          info: this.props.soldiers[i]\n        });\n      }\n    }\n\n    this.filterSuperior();\n    setTimeout(() => {\n      this.setState({\n        filteredSuperiors: [...this.state.filteredSuperiors, this.state.info.superiorId]\n      });\n    }, 0);\n  }\n\n  getObjectURL(file) {\n    var url = null;\n\n    if (window.createObjectURL !== undefined) {\n      // basic\n      url = window.createObjectURL(file);\n    } else if (window.URL !== undefined) {\n      // mozilla(firefox)\n      url = window.URL.createObjectURL(file);\n    } else if (window.webkitURL !== undefined) {\n      // webkit or chrome\n      url = window.webkitURL.createObjectURL(file);\n    }\n\n    return url;\n  }\n\n  render() {\n    const imgStyle = {\n      width: \"200px\",\n      height: \"200px\"\n    };\n    const candidateSuperiors = this.props.soldiers.filter(superior => {\n      return !this.state.filteredSuperiors.includes(superior._id);\n    });\n    const info = this.state.info;\n\n    if (this.props.redirect && !this.props.isLoading) {\n      return React.createElement(Redirect, {\n        to: {\n          pathname: '/'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      });\n    } else {\n      return React.createElement(\"div\", {\n        className: \"edit_user\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, \"Edit Soldier\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }), React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"image\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: info.imgUrl,\n        alt: \"\",\n        style: imgStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        className: \"col col-sm-2 col-lg-2 col-form-label\",\n        htmlFor: \"picture\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, \" \"), React.createElement(\"div\", {\n        className: \"col col-sm-10 col-lg-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, \"Upload Picture:\", React.createElement(\"input\", {\n        id: \"picture\",\n        type: \"file\",\n        ref: input => {\n          this.fileInput = input;\n        },\n        className: \"form-control\",\n        accept: \".jpg, .jpeg, .png\",\n        onChange: this.handleFile,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        for: \"name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"Name:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"name\",\n        value: info.name,\n        onChange: e => this.handleChange(e, 'name'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"sex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, \"Sex:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"sex\",\n        value: info.sex,\n        onChange: e => this.handleChange(e, 'sex'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"rank\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"Rank:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"rank\",\n        value: info.rank,\n        onChange: e => this.handleChange(e, 'rank'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"startDate\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, \"Start Date:\"), React.createElement(\"input\", {\n        type: \"date\",\n        class: \"form-control\",\n        id: \"startDate\",\n        value: moment.parseZone(info.startDate).format('YYYY-MM-DD'),\n        onChange: e => this.handleChange(e, 'startDate'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"phone\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"Phone:\"), React.createElement(\"input\", {\n        type: \"number\",\n        class: \"form-control\",\n        id: \"phone\",\n        value: info.phone,\n        onChange: e => this.handleChange(e, 'phone'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, \"Email:\"), React.createElement(\"input\", {\n        type: \"text\",\n        class: \"form-control\",\n        id: \"email\",\n        value: info.email,\n        onChange: e => this.handleChange(e, 'email'),\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group col-md-50\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"Superior:\"), React.createElement(\"div\", {\n        className: \"col col-sm-10 col-lg-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(\"select\", {\n        id: \"manager\",\n        onChange: this.handleSuperiorChange,\n        className: \"form-control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: null,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, info.superiorName), candidateSuperiors.map(superior => {\n        return React.createElement(\"option\", {\n          key: superior._id,\n          value: superior._id + \" \" + superior.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }, superior.name);\n      })))), React.createElement(\"button\", {\n        className: \"btn btn-success\",\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, \"Save Change\")));\n    }\n  }\n\n}\n\nexport default EditSoldier;","map":{"version":3,"sources":["/Users/Flora/myapp/src/components/EditSoldier/index.js"],"names":["React","Component","Redirect","moment","EditSoldier","constructor","props","filterSuperior","result","traverse","_id","setState","filteredSuperiors","list","push","directSubs","getDirectSubs","ds","soldiers","soldier","superiorId","handleChange","e","key","preventDefault","newObject","target","value","info","state","changed","changedInfo","handleSuperiorChange","idName","split","superiorName","handleFile","file","fileInput","files","filename","name","url","getObjectURL","imgUrl","uploadImage","handleSubmit","image","editSoldier","id","sex","rank","startDate","phone","email","numberOfDirectSubs","componentDidMount","i","length","setTimeout","window","createObjectURL","undefined","URL","webkitURL","render","imgStyle","width","height","candidateSuperiors","filter","superior","includes","redirect","isLoading","pathname","input","parseZone","format","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport moment from 'moment';\n\nclass EditSoldier extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      info: {\n        _id: null,\n        name: '',\n        sex: '',\n        rank: '',\n        startDate: '',\n        phone: '',\n        email: '',\n        superiorId: null,\n        superiorName: '',\n        numberOfDirectSubs: 0,\n        imgUrl: '',\n      },\n      changedInfo: {},\n      filteredSuperiors: []\n    };\n  }\n\n  componentDidMount() {\n    for (let i = 0; i < this.props.soldiers.length; i++){\n      if (this.props.soldiers[i]._id === this.props.id) {\n        this.setState({info : this.props.soldiers[i]});\n      }\n    }\n    this.filterSuperior();\n    setTimeout(() => {\n      this.setState({filteredSuperiors: [...this.state.filteredSuperiors,this.state.info.superiorId]});\n    }, 0); \n  }\n\n  filterSuperior = () => {\n    const result = [];\n    this.traverse(this.props._id, result);\n    this.setState({filteredSuperiors: result});\n  }\n\n  traverse = (_id, list) => {\n    if (!_id || _id === '') {\n      return;\n    }\n    list.push(_id);\n    let directSubs = this.getDirectSubs(_id);\n    for (let ds of directSubs) {\n      this.traverse(ds, list);\n    }\n  };\n  getDirectSubs = _id => {\n    let result = [];\n    const soldiers = this.props.soldiers;\n    for (let soldier of soldiers) {\n      if (soldier.superiorId === _id) {\n        result.push(soldier._id);\n      }\n    }\n    return result;\n  };\n\n  \n  handleChange = (e, key) => {\n    e.preventDefault();\n    const newObject = {};\n    newObject[key] = e.target.value;\n    const info = {\n      ...this.state.info,\n      ...newObject\n    };\n    const changed = {...this.state.changedInfo};\n    changed[key] = e.target.value;\n    this.setState({ info, changedInfo: changed});\n  }\n\n  handleSuperiorChange = e => {\n    let idName = e.target.value.split(' ');\n    const superiorId = idName[0];\n    const superiorName = idName[1];\n    const newObject = { superiorId, superiorName };\n    const info = {\n      ...this.state.info,\n      ...newObject\n    };\n    const changed = {...this.state.changedInfo, superiorId};\n    this.setState({ info, changedInfo: changed });\n  };\n\n  handleFile = () => {\n    const file = this.fileInput.files[0];\n    const filename = file.name;\n    const url = this.getObjectURL(file);\n    this.setState({info : {...this.state.info, imgUrl : url}});\n    this.props.uploadImage(file, filename);\n  };\n  getObjectURL(file) {\n    var url = null ;\n    if (window.createObjectURL!==undefined) { // basic\n        url = window.createObjectURL(file) ;\n    } else if (window.URL!==undefined) { // mozilla(firefox)\n        url = window.URL.createObjectURL(file) ;\n    } else if (window.webkitURL!==undefined) { // webkit or chrome\n        url = window.webkitURL.createObjectURL(file) ;\n    }\n    return url ;\n  }\n\n  handleSubmit = e => {\n    e.preventDefault();\n    let changedInfo;\n    if (this.props.image.imgUrl !== '') {\n      changedInfo = {...this.state.changedInfo, imgUrl: this.props.image.imgUrl};\n    } else {\n      changedInfo = {...this.state.changedInfo};\n    }\n    this.props.editSoldier(this.props.id, changedInfo);\n  };\n\n  render() {\n    const imgStyle  = {width : \"200px\", height : \"200px\"}\n    const candidateSuperiors = this.props.soldiers.filter(superior => {\n      return !this.state.filteredSuperiors.includes(superior._id);\n    });\n    const { info } = this.state;\n    if (this.props.redirect && !this.props.isLoading) {\n      return <Redirect to = {{ pathname: '/' }}/>\n    } else {\n      return (\n        <div className='edit_user'>\n          <h2>Edit Soldier</h2>\n          <br></br>\n          <form onSubmit = {this.handleSubmit}>\n\n            <div className=\"image\">\n            <img src={info.imgUrl} alt=\"\" style={imgStyle}></img>\n              <label className=\"col col-sm-2 col-lg-2 col-form-label\" htmlFor=\"picture\"> </label>\n              <div className=\"col col-sm-10 col-lg-4\">\n              Upload Picture:\n                <input\n                  id=\"picture\"\n                  type=\"file\"\n                  ref={input => {\n                    this.fileInput = input\n                  }}\n                  className=\"form-control\"\n                  accept=\".jpg, .jpeg, .png\"\n                  onChange={this.handleFile}\n                />\n              </div>\n            </div>\n\n\n            <div className=\"form-group col-md-50\" >\n              <label for = 'name'>\n                Name:\n              </label>\n              <input type = 'text' class = 'form-control' id = 'name' value = {info.name} onChange = {e => this.handleChange(e, 'name')} required = {true} />\n            </div> \n\n            <div className=\"form-group col-md-50\" >\n              <label htmlFor=\"sex\">\n                Sex:\n              </label>\n              <input type = 'text' class = 'form-control' id = 'sex' value = {info.sex} onChange = {e => this.handleChange(e, 'sex')} required = {true} />\n            </div>  \n            \n            <div className=\"form-group col-md-50\" >\n              <label  htmlFor=\"rank\">\n                Rank:\n              </label>\n              <input type = 'text' class = 'form-control' id = 'rank' value = {info.rank} onChange = {e => this.handleChange(e, 'rank')} required = {true}/>\n            </div>\n\n            <div className=\"form-group col-md-50\" >\n              <label htmlFor=\"startDate\">\n                Start Date:\n              </label>\n              <input type = 'date' class = 'form-control' id = 'startDate' value = {moment.parseZone(info.startDate).format('YYYY-MM-DD')} onChange = {e => this.handleChange(e, 'startDate')} required = {true}/>\n            </div>\n\n            <div className=\"form-group col-md-50\" >\n              <label htmlFor=\"phone\">\n                Phone:\n              </label>\n              <input type = 'number' class = 'form-control' id = 'phone' value = {info.phone} onChange = {e => this.handleChange(e, 'phone')} required = {true} />\n            </div>\n\n            <div className=\"form-group col-md-50\" > \n              <label htmlFor='text'>\n                Email: \n              </label> \n              <input type = 'text' class = 'form-control' id = 'email' value = {info.email} onChange = {e => this.handleChange(e, 'email')} required = {true} />\n            </div>\n\n            <div className=\"form-group col-md-50\" > \n              <label htmlFor='text'>\n                Superior: \n              </label> \n              <div className=\"col col-sm-10 col-lg-4\">\n                <select id=\"manager\" onChange={this.handleSuperiorChange} className=\"form-control\">\n                <option value={null}>{info.superiorName}</option>\n                {candidateSuperiors.map(superior => {\n                  return (\n                    <option key={superior._id} value={superior._id + \" \" + superior.name}>\n                      {superior.name}\n                    </option>\n                  );\n                })}\n                </select>\n              </div>\n            </div>\n\n            <button className=\"btn btn-success\" type = \"submit\">Save Change</button> \n          </form>\n        </div>\n      );\n    } \n  }\n}\n\nexport default EditSoldier;\n\n"]},"metadata":{},"sourceType":"module"}